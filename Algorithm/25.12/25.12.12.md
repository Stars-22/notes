# 25.12.12 算法刷题笔记

## 力扣：3433. 统计用户被提及情况
**链接**：https://leetcode.cn/problems/count-mentions-per-user/  
**相关标签**：`数组` `数学` `排序` `模拟`  
**难度**：`中等`
### 方法1：`事件驱动模拟`
- **时间复杂度**：$O(mn + m \log m)$
- **空间复杂度**：$O(n + \log m)$
```cpp
class Users{
private:
    vector<int> mentions;
    vector<int> isOnline;
    int now;
public:
    Users(int n) : mentions(vector<int>(n, 0)), isOnline(vector<int>(n, 0)), now(0) {}
    void setTime(int n){ now = n; }
    void setOffline(int n){ isOnline[n] = now + 60; }
    void mention(int n){ mentions[n]++; }
    void mentionOnline(){ for(int i=0; i<mentions.size(); i++) if(isOnline[i] <= now) mention(i); }
    void mentionAll(){ for(int i=0; i<mentions.size(); i++) mention(i); }
    vector<int> getMentions(){ return std::move(mentions); }
};
class Solution {
public:
    vector<int> countMentions(int numberOfUsers, vector<vector<string>>& events) {
        sort(events.begin(), events.end(), [](const vector<string>& a, const vector<string>& b) {
            int timeA = stoi(a[1]);
            int timeB = stoi(b[1]);
            if(timeA != timeB) return timeA < timeB;
            if(a[0] == "OFFLINE" && b[0] != "OFFLINE") return true;
            return false;
        });
        Users u(numberOfUsers);
        for(const auto& e : events){
            u.setTime(stoi(e[1]));
            if(e[0] == "OFFLINE") u.setOffline(stoi(e[2]));
            else{
                if(e[2] == "ALL") u.mentionAll();
                else if(e[2] == "HERE") u.mentionOnline();
                else{
                    const string& s = e[2];
                    int n = 0;
                    for(int i=0; i<=s.size(); i++){
                        if(s[i] == 'i' || s[i] == 'd') continue;
                        if(s[i] == ' ' || i == s.size()){
                            u.mention(n);
                            n = 0;
                            continue;
                        }
                        n *= 10;
                        n += s[i] - '0';
                    }
                }
            }
        }
        return u.getMentions();
    }
};
```